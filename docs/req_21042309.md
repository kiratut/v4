# Requirements Consolidated Table (Экспорт для Excel)

> Экспортировано из Excel req.xlsx (дата: 23.09.2025 21:04)

=== ROW ===
Requirement ID:2
Requirement Description:Функциональные требования
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.1
Requirement Description:Самодиагностика
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.1.1 
Requirement Description:Достаточность локальных ресурсов ОС
Расширенное описание:Контроль ресурсов\: диск <20%, память <20%, процессор >90% (критерии проблемы). Пороговые значения в параметрах. Нужно замерять среднее потребление за период с предыдущего заметра (например, 1 сек - параметр частоты).
Test ID:test_resource_monitoring_critical_thresholds 
Test Description:Проверка мониторинга ресурсов с минимальными порогами. В тесте передаются мин параметры по очереди и фиксируется появление флага тревоги. 
Test Criteria:Диск >0%, память >0%, CPU >0% 
Module Path:core/scheduler_daemon.py 
Function Name:_execute_system_health 
Function Description:Снимает метрики CPU/RAM/Disk, формирует alerts 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[System_Revision_Report_archived.md] 
=== ROW ===
Requirement ID:2.1.2 
Requirement Description:Активность демона
Расширенное описание:Формирует статус сервиса\: запущен, отвечает номер версии, время запуска в локали и в unix
Test ID:test_service_status_response 
Test Description:Проверка статуса сервиса, номера версии, время запуска.
Test Criteria:Статус "включен" (или эквивалент), номер версии соответствует параметру, время запуска не пустое и ранее текущего времени.
Module Path:core/scheduler_daemon.py 
Function Name:get_status 
Function Description:Возвращает агрегированный статус планировщика 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Project_v4.md] 
=== ROW ===
Requirement ID:2.1.3 
Requirement Description:Наличие авторизации HH
Расширенное описание:Собирает статусы по включенным профилям авторизации hh. При наличии проблем на любом профиле за прошедший период накопления диагностики - пропорциональное снижение % рабочих профилей.
Test ID:test_02_api_auth_headers 
Test Description:Проверка авторизации 
Test Criteria:При наличии включенных профилей общий статус авторизации >0%
Module Path:core/auth.py 
Function Name:apply_auth_headers 
Function Description:Применяет заголовки авторизации 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[config/auth_roles.json] 
=== ROW ===
Requirement ID:2.1.4 
Requirement Description:Активность удаленной БД 
Расширенное описание:Формирует статус линка\: активна/деактивирована, запущена/остановлена, пинг, номер версии, время запуска, занятый объём удаленной БД.
Test ID:test_database_integrity_check 
Test Description:Проверка статуса и отклика БД
Test Criteria:Если активна, то запущена, пинг <300, отвечает номер версии, время запуска не пустое, занятый объём менее макс.объёма удаленной БД (параметр). 
Module Path:core/database_v3.py 
Function Name:get_system_info 
Function Description:Получает сводную информацию о БД 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Database_Schema_v4.md] 
=== ROW ===
Requirement ID:2.1.5 
Requirement Description:Активность LLM API 
Расширенное описание:Формирует статус линка для каждого профиля LLM\: активный/деактивирован, пинг, номер версии, ответ сервера.
Test ID:
Test Description:Проверка статуса и отклика по каждому профилю LLM
Test Criteria:Если профиль активный, то пинг <300, есть не ошибочный ответ сервера, отвечает номер версии и баланс или дни подписки > 0. 
Module Path:core/host3_client.py 
Function Name:health_check 
Function Description:Отдает состояние LLM клиента (mock) 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Host_Stubs_Implementation_Report_archived.md] 
=== ROW ===
Requirement ID:2.1.6 
Requirement Description:Защита от зависания и ошибок
Расширенное описание:Проверка наличия записей в логе за период (параметр) и наличие ошибок.
Test ID:test_critical_event_logging 
Test Description:Проверка наличия записей в логе за период (параметр) и наличие ошибок.
Test Criteria:Записи есть, ошибок нет.
Module Path:core/db_log_handler.py, web/server.py, tests/consolidated_tests.py 
Function Name:_check_timeouts 
Function Description:Находит и помечает зависшие задачи 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[System_Revision_Report_archived.md] 
=== ROW ===
Requirement ID:2.1.7 
Requirement Description:Сжатие самодиагностики для отправки в Telegram
Расширенное описание:Упаковка отчёта самодиагностки в короткое сообщение и вложение.
Test ID:test_telegram_critical_alerts 
Test Description:Проверка наличия тела сообщения самодиагностики в БД за период
Test Criteria:Есть короткие сообщения, менее 255 символов.
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.2
Requirement Description:Обслуживание
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.2.1 
Requirement Description:Очистка старых логов 
Расширенное описание:Файловые логи >1 суток\: сжатие в суточный архив. Периодичность - параметр. Логи в БД >30 суток или более 10000 строк - удаление. Макс.длительность и макс.строк - параметры.
Test ID:
Test Description:Проверка наличия файловых логов более Периодичность+10%. Проверка наличия логов в БД более Макс.длительность+10% или Макс.строк+10%. 
Test Criteria:Нет старых файлов логов. Нет превышения логво в БД.
Module Path:cli_v4.py 
Function Name:cleanup 
Function Description:Перемещает/удаляет старые логи 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[V4_RUNBOOK.md] 
=== ROW ===
Requirement ID:2.2.2 
Requirement Description:Очистка архивов логов
Расширенное описание:Архивы логов >100МБ\: удаление самых старых архивов. Макс объем - параметр. Запись в лог.
Test ID:
Test Description:Проверка наличия архивов логов более макс.объем+10%. Есть логирование.
Test Criteria:Нет старых архивов логов при превышении макс.объёма. В логах за последние 2 суток есть записи проверки объёма архивов логов.
Module Path:cli_v4.py 
Function Name:cleanup 
Function Description:Удаляет крупные архивы по порогу 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[V4_RUNBOOK.md] 
=== ROW ===
Requirement ID:2.2.3 
Requirement Description:Архивация старых вакансий 
Расширенное описание:Вакансии >30 суток\: экспорт и сжатие. Очистка полей кроме id вакансий и версии. Макс.срок - параметр. Запись в лог.
Test ID:
Test Description:Проверка наличия вакансий (кроме нескольких неудаляемых полей) более макс.срок+10%. Есть логирование.
Test Criteria:Нет старых логов. В логах есть записи проверки объёма архивов.  В логах за последние 2 суток есть записи проверки объёма архивов.
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.2.4 
Requirement Description:Очистка архивов вакансий
Расширенное описание:Архивы вакансий >1000МБ\: удаление 10% самых старых архивов. Макс объем - параметр. Достижение макс.объёма-5% - предупреждение в телеграмм. Запись в лог.
Test ID:test_cleanup_command 
Test Description:Проверка наличия архивов логов более макс.объем+10%. Есть логирование.
Test Criteria:Нет старых архивов вакансий при превышении макс.объёма.В логах за последние 2 суток есть записи проверки объёма архивов. Поиск в логах записей удаления архивов и записей отправки в телеграмм, если обе имеются и ближайшая с конца удаление, то успешный тест.
Module Path:cli_v4.py 
Function Name:cleanup 
Function Description:Находит крупные архивы, шлёт alert, планирует удаление 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.2.5
Requirement Description:Очистка БД
Расширенное описание:Записи индикаторов > 30 дней\: удаление 10% самых старых записей. Макс кол-во дней - параметр. 
Test ID:
Test Description:Проверка наличия записей индикаторов более макс.дней +10%. 
Test Criteria:Нет старых записей.
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:2 
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.2.6
Requirement Description:Мониторинг бюджета LLM API 
Расширенное описание:Опрос остатка токенов и сроков подписки всех активных LLM, фиксация в логах, предупреждение в Telegram о достижении лимита. Лимит в токенах и днях подписки - параметр для каждого профиля LLM. 
Test ID:test_telegram_critical_alerts 
Test Description: В логах есть записи удаления архивов и записи предупреждения в телеграмм.
Test Criteria:Если есть включенные профили LLM , то логах за последние 2 суток должны быть записи проверки остатка лимитов.
Module Path:core/host3_client.py 
Function Name:health_check 
Function Description:Возвращает usage/limit и шлёт alert при low-quota 
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Host_Stubs_Implementation_Report_archived.md] 
=== ROW ===
Requirement ID:2.3
Requirement Description:Логирование
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.3.1 
Requirement Description:Общий модуль логирования 
Расширенное описание:Централизованное логирование в БД и в файлы. Логирование настраиваемых статусов в БД (список статусов - параметр). Логирование настраиваемых статусов в файлы (список статусов - параметр). Логирование набора dev test в файл union_test.log
Test ID:test_critical_event_logging 
Test Description:Проверка наличия файлов и таблиц и записей логов в них.
Test Criteria:Существует единый файл логов app.log и последняя запись менее суток назад. Кроме union_test.log нет других файлов .log в папке. Существуют таблицы логов в БД и есть записи за последние сутки.
Module Path:core/db_log_handler.py, web/server.py, tests/consolidated_tests.py 
Function Name:__init__ 
Function Description:Единый logs/app.log с ротацией 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[System_Revision_Report_archived.md] 
=== ROW ===
Requirement ID:2.3.2 
Requirement Description:Трассировка модулей и функций в логах
Расширенное описание:В файловом логе префиксы-коды модулей в строках лога. В БД поля имени модуля и функции - источника события лога.
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.3.3 
Requirement Description:Табличный лог в Excel 
Расширенное описание:Вывод табличных логов и результатов в excel файл, в т.ч. с сохранием форматирования листов (вставка значений, выставление типа ячеек). Добавление строк снизу или замена значений при наличии индексного поля.
Test ID:
Test Description:Проверка вывода 1 строки в технический лист табличного лога. Чтение файла xlsx и проверка наличия листа и количества записей до и после.
Test Criteria:Добавилась 1 запись.
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.4
Requirement Description:Сервис-демон
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.4.1 
Requirement Description:Запуск и останов демона 
Расширенное описание:Команды запуска и останова демона. Сохранение в параметрах времени последнего события, статуса события и id процесса ОС запуска/остановки демона. Проверка активности демона и закрытия перед новым запуском. Сохранение в лог, в т.ч. диагностику исключений в Error событиях. 
Test ID:test_dispatcher_start_command 
Test Description:Проверка статуса после запуска и останова.
Test Criteria:Демон выдает статус активности или не отвечает. Время запуска демона совпадает с тестом.
Module Path:cli_v4.py 
Function Name:start 
Function Description:Запускает диспетчер задач 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[V4_RUNBOOK.md] 
=== ROW ===
Requirement ID:2.4.2 
Requirement Description:Запуск/перезапуск панели 
Расширенное описание:ВАЖНО: Автостарт web-сервиса панели-пульта при запуске демона. Останов web-сервиса при остановке или ошибке-исключении демона. Web-сервер НЕ тестируется отдельно - только вместе с демоном! Перезапуск web-сервиса. Сохранение в параметрах времени последнего события, статуса события, id процесса ОС (при запусках как отдельный процесс) и адреса\:порта запуска/остановки web-сервиса. Проверка активности web-панели и наличия статуса "Включено" как текста на странице. Сохранение в лог. 
Test ID:test_web_interface_command 
Test Description:Проверка активного статуса, времени работы, наличия информации на странице. Проверка смены id процесса при перезапуске. Проверка отсутствия процесса при остановке.
Test Criteria:Web-сервис активный и выдает время работы > 0. Id процесса изменяется. Процесс останавливается и адрес не отвечает.
Module Path:web/monitoring_dashboard.py 
Function Name:api_version 
Function Description:Возвращает информацию о версии API 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Dashboard_Specification_v4.md] 
=== ROW ===
Requirement ID:2.4.3 
Requirement Description:Периодическая диагностика
Расширенное описание:Раз в 5 минут (параметр) вызывается самодиагностика (п.2.1) и выводится на панель, записывается в лог. При наличии тревог и предупреждений - формируется сообщение и отправляется в телеграмм.
Test ID:test_system_health_task 
Test Description:Проверка работы самодиагностики через поиск в логах предыдущих записей и парсинг.
Test Criteria:В логе есть минимум 1 запись за двойной период самодиагностики 5х2 минут. В записе есть минимум 1 проверка из списка (п.2.1).
Module Path:core/scheduler_daemon.py 
Function Name:_execute_system_health 
Function Description:Запускает проверки ресурсов 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[System_Revision_Report_archived.md] 
=== ROW ===
Requirement ID:2.4.4 
Requirement Description:Обновление вывода в панели 
Расширенное описание:Панель отображает текущие, средние и накопительные значения в разных индикаторах. Каждый индикатор имеет формулу или запрос БД с пост-обработкой и форматированием в индикаторе. Раз в 1 минуту (параметр) демон инициирует пересчёты индикаторов и статусов кнопок/других контролов с записью в БД. Через паузу 1 секунда (параметр) панель забирает данные из БД. Данные от расчетов с временем акутальности далее параметра обновления отображаются особым цветом (фиолетовый - настройка). В панели выводится максимальное время данных (в локали и в unix-формате). ПОВЕДЕНИЕ БЕЗ ДЕМОНА: панель работает в degraded режиме, показывает предупреждение "Демон не запущен", отключает управляющие кнопки (freeze workers, clear queue), показывает кешированные/fallback значения, индикаторы устаревших данных выделены цветом.
Test ID:test_web_dashboard_main_page 
Test Description:Запрос максимального времени индикаторных значений в БД и поиск на странице этого времени в unix-формате.
Test Criteria:Время найдено и совпадает до секунды.
Module Path:web/static/dashboard.js 
Function Name:updateStats 
Function Description:Обновляет показатели на панели 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Dashboard_Specification_v4.md] 
=== ROW ===
Requirement ID:2.4.5 
Requirement Description:Управление диспетчером задач 
Расширенное описание:Автоматическое включение диспетчера таскеров, запуск очереди и таскеров. Кнопки заморозка работы таскеров, очистка очереди. Отображение количества запущенных и занятых таскеров, ожидаемого времени окончания всех задач в очереди. Инициализация новых таскеров, запись в таблицу БД  id таскеров, очистка от id предыдущих записей. Обновление в БД статуса каждого таскера и каждой задачи в очереди после начала работой над задачей и окончания. Фильтрация доступных к работе задач по параметру типа задачи (поиск id, загрузка версий, отклики). Закрепление задач за таскерами. Прерывание задачи более лимита секунд (параметр). Запись в лог ошибок и прерываний задач, начала работы над очередью и окончание.
Test ID:test_task_manager_basic_operations 
Test Description:Проверка активного состояния диспетчера, количества запущенных таскеров. 
Test Criteria:Диспетчер активный и кол-во запущенных таскеров соответствует заданному (параметр).
Module Path:core/db_log_handler.py, web/server.py, tests/consolidated_tests.py 
Function Name:add_task, schedule_task, calculate_eta, get_progress, log_error, _check_timeouts 
Function Description:Добавляет задачи и обновляет статус , Планирует выполнение задач по расписанию, Рассчитывает прогноз завершения задач , Возвращает процент выполнения задачи , Логирует ошибки с полным контекстом , Принудительно завершает зависшие задачи
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[System_Revision_Report_archived.md] 
=== ROW ===
Requirement ID:2.4.6 
Requirement Description:Отправка уведомлений в Telegram
Расширенное описание:Мониторинг (раз в минуту - параметр) очереди неотправленных телеграмм-сообщений, разрешенных к отправке. Запрос доступности и готовности к работе API телеграмм. Отправка в API телерамм из очереди, получение ответа и сохранение в записи сообщения, выставление статуса Доставлено, запись в лог ошибок, при банах - выставление времени повторной отправки с задержкой (5 минут - параметр).
Test ID:test_cleanup_command 
Test Description:Проверка доступности и готовности к работе API телеграмм. Проверка очереди телеграмм-сообщений и отложенных сообщений. 
Test Criteria:API доступно и без бана. Очередь существует, но неотправленных сообщений в ней 0.
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.4.7
Requirement Description:Основной рабочий цикл на хосте 1 (загрузка вакансий)
Расширенное описание:1.1. Запуск загрузки вакансий каждый период (день/час)  \n1.2. Поиск через API hh.ru всех запросов в filters.json (до 30 000 вакансий) за период+наложение  \n1.3. Подсчет страниц и количества вакансий  \n1.4. Загрузка в БД1 всех ID найденных вакансий (исключение дублей по ID)  \n1.5. Загрузка текстов вакансий по очереди ID  \n1.6. Проверка на дубли по набору ключей  \n1.7. Запись новых вакансий в БД1 с версией (новая версия или версия 1)  \n1.8. Сохранение в БД1 с новой версией или версией 1  \n1.9. Расчет дополнительных аналитических полей для новых версий  
Test ID:
Test Description:Как уже описано в других требованиях, нужно пройти полный цикл на test запросе (-ах).
Test Criteria:Отсутствие ошибок. Увеличение кол-ва строк вакансий в БД.
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.5
Requirement Description:Панель-пульт
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.5.1 
Requirement Description:Расчет показателей по логам и записям в БД
Расширенное описание:Расчет за период (с предыдущего запроса) количества уникальных id вакансий из запросов к hh API, количества загруженных версий вакансий, количества новых вакансий, кол-ва новых работодателей, кол-во версий вакансий к загрузке (по ожидающим id в очереди) и пронозное время окончания всех загрузок в очереди. Расчет средней скорости получения id и загрузки версий вакансий. Расчет кол-ва банов/каптчей hh API. Фильтрация незаконченных (с указанием id таскера) и не начатых задач.
Test ID:test_stats, test_database_statistics_calculation 
Test Description:Проверка наличия статистики по показателям за период периодичности расчета. Сверка с максимальным временем запуска задач загрузки таскерами.
Test Criteria:Все показатели присутствуют, значения >=0. Если макс.время запуска таскера в границах периода расчета, то не могут быть сразу все значения =0.
Module Path:web/server.py , core/database_v3.py 
Function Name:analyze_logs , get_stats 
Function Description:Парсит логи и вычисляет метрики 
Будущие требования:Статистика по откликам.
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Dashboard_Specification_v4.md] 
=== ROW ===
Requirement ID:2.5.2
Requirement Description:Вывод показателей самодиагностики
Расширенное описание:Обращение к рассчитанным метрикам (п.2.1). Форматирование в рамки. Отображение сигнала устаревших данных и времени, если максимальное время даных более периода самодиагностики. 
Test ID:test_system_health_check 
Test Description:Текстовый поиск на странице панели unix-времени запуска демона.
Test Criteria:Найдено время
Module Path:core/scheduler_daemon.py 
Function Name:_execute_system_health 
Function Description:Собирает системные метрики для панели 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Dashboard_Specification_v4.md] 
=== ROW ===
Requirement ID:2.5.6 
Requirement Description:Сжатие показателей в сводки Telegram и отправка
Расширенное описание:Упаковка истории показателей за период (сутки - параметр) в короткое сообщение и вложение.
Test ID:
Test Description:Проверка наличия тела сообщения-сводки в БД за период
Test Criteria:Есть короткие сообщения, менее 255 символов.
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.5.7 
Requirement Description:Ручное обновление 
Расширенное описание:Кнопка - принудительный перерасчет 2.5.1, чтение 2.5.2 и обновление данных на панели. Запись в лог события нажатия доступной для нажатия кнопки.
Test ID:test_filters_management_ui
Test Description:Проверка отображения фильтров в панели
Test Criteria:Фильтры отображаются с правильными типами test/prod
Module Path:web/static/dashboard.js
Function Name:toggleAllFilters, invertFilters
Function Description:Управление активностью фильтров через UI
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Dashboard_Specification_v4.md] 
=== ROW ===
Requirement ID:2.5.8 
Requirement Description:Управление частотой/расписанием загрузок 
Расширенное описание:Параметр - частота загрузок (раз в Х часов, поставить 1 час). Вывод параметра из конфига в поле ввода. Запись в конфиг нового значения параметра из поля ввода. Параметр частота загрузок= 0 - загрузки остановлены., но начатые нужно выполнить и новые id вакансий не запрашивать. Добавить вывод следующего времени начала загрузки (с учетом частоты и времени начала предыдущих/текущих загрузок); если Параметр частота загрузок= 0, то в поле выводить "Загрузки выкл.". Если параметр меняется с 0 на любое значение, то запускается загрузка и начинается новый отчет следующей, если с не 0 на не 0, то считается прошедшее время и если уже наступило следующее по параметру, то запускаются загрузки. Изменения параметра логируются. Если время следующего запуска загрузок наступило, то (1) отмена в  очереди не выполненных полностью задач поиска id вакансий, (2) в цикле по включенным prd фильтрам наполнение очереди задач задачами поиска id вакансий.
Test ID:test_schedule_frequency_control
Test Description:Выставление фильтра 1 любой вакансии, выставление параметра частоты на 1000, пауза 1 сек, потом частота 0. Проверка в логах записи начала загрузки по расписанию с временем примерно временем теста. Возврат времени частоты загрузок к значению в настройках.
Test Criteria:Запись найдена.
Module Path:web/static/dashboard.js
Function Name:updateFrequency
Function Description:Управляет частотой загрузок через панель
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Dashboard_Specification_v4.md] 
=== ROW ===
Requirement ID:2.5.9 
Requirement Description:Включение/выключение фильтров для загрузки 
Расширенное описание:Использование параметра типа фильтра (test, prod) и активности (true, false) в коллекции фильтров filters.json. Вывод списка фильтров в таблицу-контрол со скроллингом на панели с отдельными столбцами\: активность, тип, статус, запрос. Использовать чек-боксы для первой колонки Активный. Добавить кнопки управления Активностью над таблицей - вкл все, выкл все, инвертировать. При изменении любой строки - переносить в  filters.json в формате json (колонку статус не переносить). При обновлении панели - забирать последние данные из  filters.json. Сортировка по полям Активность, Тип по нажатию на заголовок колонки. При обновлении панели или при изменении в таблице-контроле пересчитывать и выводить над таблицей правее кнопок "Всего фильтров Х, из них вкл dev Y, test Z". В колонку статус по строкам фильтров выводить\: (1) при запуске панели - очищать, (2) при начале поиска по списку фильтров - "wait ids", при начале поступления id вакансий от hh API "X ids" где X кол-во полученных уникальных id на момент обновления табло, при начале загрузки версий вакансий "Y% of X", при новом цикле - очищать.
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Dashboard_Specification_v4.md] 
=== ROW ===
Requirement ID:2.6
Requirement Description:Настройка
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.6.1 
Requirement Description:Ведение фильтров поиска вакансий
Расширенное описание:Управление поисковыми запросами в filters.json\: добавление/удаление фильтров, тестирование запросов, включение/отключение фильтров. Параметры\: per_page (default\: 100), search_period (30 дней), area (регион поиска), experience (опыт работы), employment (тип занятости), schedule (график работы), salary (зарплата от/до), text (ключевые слова). Параметры конфигурации\: filters_file_path, default_per_page, default_search_period
Test ID:test_filters_file_structure
Test Description:Проверка структуры filters.json
Test Criteria:Файл содержит поля type, active, params
Module Path:config/filters.json
Function Name:N/A
Function Description:JSON конфигурация поисковых фильтров
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Regular_Procedures_v4.md]  Статус\: Planned. Архитектура\: Будет использоваться notification модулем
=== ROW ===
Requirement ID:2.6.2 
Requirement Description:Настройки отправки в Telegram
Расширенное описание:Параметры API Телеграмм в config_v4.json\: telegram.bot_token (токен бота), telegram.chat_id (ID чата), telegram.enabled (вкл/выкл уведомлений), telegram.alerts_enabled (вкл/выкл тревог), telegram.test_message (тестовое сообщение), telegram.retry_delay_minutes (задержка при бане), telegram.max_message_length (макс длина сообщения). Параметры конфигурации\: telegram_bot_token, telegram_chat_id, telegram_enabled, telegram_alerts_enabled
Test ID:test_telegram_critical_alerts 
Test Description:Проверка формата token, chat_id. Тестовое сообщение.
Test Criteria:Значения не пустые и по формату token, chat_id. Сообщение доставлено (даже с выкл).
Module Path:config/config_v4.json
Function Name:N/A
Function Description:Telegram настройки в главном конфиге
Будущие требования:
Приоритет:2
Дата:
Техническая информация:[Dashboard_Specification_v4.md]  Статус\: Implemented. Архитектура\: Используется web/monitoring_dashboard.py и dashboard.js
=== ROW ===
Requirement ID:2.6.3 
Requirement Description:Настройки отображения панели
Расширенное описание:Параметры панели в config_v4.json\: dashboard.refresh_interval_ms (частота обновления), dashboard.port (порт веб-сервера), dashboard.host (адрес привязки), dashboard.theme (тема оформления), dashboard.cards_per_row (карточек в ряду), dashboard.show_unix_time (показывать Unix время), dashboard.stale_data_color (цвет устаревших данных). Параметры конфигурации\: dashboard_refresh_interval, dashboard_port, dashboard_host, dashboard_theme
Test ID:
Test Description:
Test Criteria:
Module Path:config/config_v4.json, config/dashboard_layout.json
Function Name:N/A
Function Description:Конфигурация веб-панели управления
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[V4_RUNBOOK.md]  Статус\: Implemented. Архитектура\: Читается core/scheduler_daemon.py при инициализации
=== ROW ===
Requirement ID:2.6.4 
Requirement Description:Настройки сервиса 
Расширенное описание:Все параметры демона в config_v4.json\: daemon.pid_file (файл PID), daemon.log_level (уровень логов), daemon.max_workers (макс воркеров), daemon.task_timeout_minutes (таймаут задач), daemon.health_check_interval (интервал проверки), daemon.auto_start_web (автозапуск панели), daemon.background_mode (фоновый режим), daemon.status_file (файл статуса). Параметры конфигурации\: daemon_pid_file, daemon_log_level, daemon_max_workers, daemon_task_timeout
Test ID:test_config_file_loading 
Test Description:Загрузка config_v4.json 
Test Criteria:Конфигурация валидируется и применяется 
Module Path:config/config_v4.json
Function Name:N/A
Function Description:Основные настройки демона планировщика
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[config/auth_roles.json]  Статус\: Implemented. Архитектура\: Интегрирован с plugins/fetcher_v4.py для ротации профилей
=== ROW ===
Requirement ID:2.6.5 
Requirement Description:Авторизация 
Расширенное описание:Настройки профилей HH в config/auth_roles.json\: profiles[] (список профилей), profile.name (имя профиля), profile.user_agent (User-Agent заголовок), profile.headers (дополнительные заголовки), profile.enabled (активность профиля), profile.rotation_minutes (ротация профиля), profile.max_requests_per_hour (лимит запросов), fallback_user_agent (резервный UA при 400 ошибке). Параметры конфигурации\: auth_profiles_file, fallback_user_agent, rotation_interval
Test ID:test_hh_multiple_auth_profiles 
Test Description:
Test Criteria:
Module Path:config/auth_roles.json
Function Name:apply_auth_headers
Function Description:Применяет заголовки авторизации из профилей
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[config/config_v4.json]  Статус\: Implemented. Архитектура\: Центральный компонент для управления всеми задачами системы
=== ROW ===
Requirement ID:2.6.6 
Requirement Description:Настройки диспетчера 
Расширенное описание:Параметры диспетчера задач в config_v4.json\: task_dispatcher.max_concurrent_tasks (макс одновременных задач), task_dispatcher.queue_size_limit (лимит очереди), task_dispatcher.worker_pool_size (размер пула воркеров), task_dispatcher.task_retry_attempts (попытки повтора), task_dispatcher.heartbeat_interval (интервал heartbeat), task_dispatcher.cleanup_interval (интервал очистки), task_dispatcher.timeout_check_interval (проверка таймаутов). Параметры конфигурации\: max_concurrent_tasks, queue_size_limit, worker_pool_size, task_retry_attempts
Test ID:test_task_manager_basic_operations 
Test Description:
Test Criteria:
Module Path:core/db_log_handler.py, web/server.py, tests/consolidated_tests.py
Function Name:add_task, schedule_task, calculate_eta
Function Description:Диспетчер задач с очередью и воркерами
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[V4_RUNBOOK.md]  Статус\: Implemented. Архитектура\: Единый logs/app.log с ротацией, интеграция с БД
=== ROW ===
Requirement ID:2.6.7 
Requirement Description:Настройки логирования 
Расширенное описание:Настройки логирования в config_v4.json\: logging.level (DEBUG/INFO/WARNING/ERROR), logging.file_path (путь к файлу), logging.max_file_size_mb (макс размер файла), logging.backup_count (количество архивов), logging.format (формат записей), logging.db_enabled (логирование в БД), logging.db_levels (уровни для БД), logging.console_enabled (вывод в консоль). Параметры конфигурации\: log_level, log_file_path, max_file_size_mb, backup_count, log_format
Test ID:
Test Description:
Test Criteria:
Module Path:core/db_log_handler.py, web/server.py, tests/consolidated_tests.py
Function Name:__init__
Function Description:Настройка централизованного логирования
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Regular_Procedures_v4.md]  Статус\: Implemented. Архитектура\: Интегрирован с notification системой для отправки алертов
=== ROW ===
Requirement ID:2.6.8 
Requirement Description:Настройки самодиагностики 
Расширенное описание:Пороговые значения самодиагностики в config_v4.json\: health_check.cpu_threshold_percent (порог CPU), health_check.memory_threshold_percent (порог RAM), health_check.disk_threshold_percent (порог диска), health_check.check_interval_minutes (интервал проверки), health_check.alert_cooldown_minutes (задержка алертов), health_check.stale_data_minutes (устаревшие данные), health_check.critical_thresholds (критические пороги). Параметры конфигурации\: cpu_threshold, memory_threshold, disk_threshold, check_interval, alert_cooldown
Test ID:test_system_health_check 
Test Description:
Test Criteria:
Module Path:core/scheduler_daemon.py
Function Name:_execute_system_health
Function Description:Мониторинг системных ресурсов и формирование алертов
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[config/config_v4.json]  Статус\: Planned (Mock). Архитектура\: Mock реализация для будущей интеграции с реальными LLM API
=== ROW ===
Requirement ID:2.6.9 
Requirement Description:Настройки запросов к LLM 
Расширенное описание:Параметры LLM API в config_v4.json\: llm.provider (OpenAI/Anthropic/Local), llm.model (модель ИИ), llm.api_key (ключ API), llm.base_url (базовый URL), llm.max_tokens (макс токенов), llm.temperature (температура), llm.timeout_seconds (таймаут запроса), llm.retry_attempts (попытки повтора), llm.quota_threshold (порог квоты), llm.enabled (включение ИИ анализа). Параметры конфигурации\: llm_provider, llm_model, llm_api_key, llm_max_tokens, llm_temperature
Test ID:test_host3_client_stub 
Test Description:Проверка LLM заглушки 
Test Criteria:health_check возвращает конфигурацию, max_tokens читается 
Module Path:core/host3_client.py
Function Name:health_check
Function Description:Mock клиент для LLM API с проверкой квот
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[config/config_v4.json]  Статус\: Planned (Mock). Архитектура\: Mock реализация для будущей интеграции с реальными LLM API
=== ROW ===
Requirement ID:2.8
Requirement Description:Авторизация HH
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.8.1 
Requirement Description:Диагностика работы профилей авторизации hh.ru 
Расширенное описание:Проверка состояния профилей 
Test ID:test_hh_authorization 
Test Description:Тестирование профилей 
Test Criteria:Все профили проверяются автоматически 
Module Path:core/auth.py 
Function Name:test_profile 
Function Description:Проверяет работоспособность профиля 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.8.2 
Requirement Description:Выбор профиля HH авторизации по задачам/таскерам 
Расширенное описание:Получение запросов на hh авторизацию от запущенных таскеров или модулей. Выбор профиля и механики авторизации из auth_roles.json по приоритету и типу (загрузка/отклики) с учётом отсутствия активного бана/каптчи профиля.
Test ID:test_hh_multiple_auth_profiles 
Test Description:Ротация профилей 
Test Criteria:Профили распределяются по задачам 
Module Path:core/auth.py 
Function Name:get_profile_for_task 
Function Description:Выбирает оптимальный профиль для задачи 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[config/auth_roles.json] 
=== ROW ===
Requirement ID:2.8.3 
Requirement Description:Обработка ошибок и банов API HH
Расширенное описание:Диагностика ответов API. Повторный возврат после паузы к приоритетному профилю при восстановлении авторизации.
Test ID:test_api_auth_profile_rotation 
Test Description:Ротация при ошибках 
Test Criteria:При 403/429 переключается на другой профиль 
Module Path:core/auth.py 
Function Name:rotate_on_error 
Function Description:Автоматически переключает профили при ошибках 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.8.4 
Requirement Description:Тестирование и перебор параметров авторизации HH 
Расширенное описание:Цикл запросов при бане/каптче с экспоненциальной задержкой. Ротация профилей при ошибках.
Test ID:test_api_auth_profile_rotation 
Test Description:Тестирование параметров 
Test Criteria:Различные комбинации User-Agent тестируются 
Module Path:plugins/fetcher_v4.py 
Function Name:test_auth_params 
Function Description:Перебирает различные параметры авторизации 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.9
Requirement Description:Авторизация LLM
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:3
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.9.1 
Requirement Description:Диагностика работы профилей авторизации LLM 
Расширенное описание:Мониторинг LLM профилей 
Test ID:test_health_check 
Test Description:Проверка LLM health 
Test Criteria:health\: status/latency возвращаются стабильно 
Module Path:core/host3_client.py 
Function Name:health_check 
Function Description:Возвращает состояние и метрики LLM клиента (mock) 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Host_Stubs_Implementation_Report_archived.md] [V4_RUNBOOK.md] 
=== ROW ===
Requirement ID:2.9.2 
Requirement Description:Выбор профиля LLM авторизации по задачам/таскерам (auth_roles.json) 
Расширенное описание:Распределение LLM профилей 
Test ID:
Test Description:
Test Criteria:Профиль выбирается по роли задачи (auth_roles/config) 
Module Path:core/host3_client.py 
Function Name:__init__ 
Function Description:Загружает provider/model по роли из конфигурации 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[config/config_v4.json] [config/auth_roles.json] 
=== ROW ===
Requirement ID:2.9.3 
Requirement Description:Обработка ошибок и банов LLM (ротация в круге применимости, остановка при отказах всех) 
Расширенное описание:Восстановление после блокировок LLM 
Test ID:
Test Description:
Test Criteria:Ротация/остановка по политике ролей; mock-режим 
Module Path:core/host3_client.py 
Function Name:classify_vacancy 
Function Description:Возвращает status и поддерживает retry/backoff (mock) 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Host_Stubs_Implementation_Report_archived.md] [Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.10
Requirement Description:База данных
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.10.1 
Requirement Description:Диагностика здоровья 
Расширенное описание:Проверка состояния БД 
Test ID:test_database_health_check 
Test Description:Health check БД 
Test Criteria:Целостность, размер, производительность 
Module Path:core/database_v3.py 
Function Name:check_health 
Function Description:Выполняет комплексную диагностику БД 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.10.2 
Requirement Description:Замер скорости 
Расширенное описание:Тестирование производительности БД 
Test ID:test_database_optimization 
Test Description:Performance тесты 
Test Criteria:Время запросов измеряется и логируется 
Module Path:core/database_v3.py 
Function Name:benchmark_queries 
Function Description:Измеряет скорость выполнения запросов 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Database_Schema_v4.md] 
=== ROW ===
Requirement ID:2.10.3 
Requirement Description:Сохранение/обновление записей 
Расширенное описание:Операции записи данных 
Test ID:test_vacancy_deduplication 
Test Description:CRUD операции 
Test Criteria:Данные сохраняются с версионированием 
Module Path:core/database_v3.py 
Function Name:save_vacancy 
Function Description:Сохраняет вакансии с дедупликацией 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.10.4 
Requirement Description:Чтение 
Расширенное описание:Операции чтения данных 
Test ID:test_database_health_check 
Test Description:Операции чтения 
Test Criteria:Данные читаются корректно и быстро 
Module Path:core/database_v3.py 
Function Name:get_vacancy 
Function Description:Извлекает данные вакансий 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Database_Schema_v4.md] 
=== ROW ===
Requirement ID:2.10.5 
Requirement Description:Экспорт в файл 
Расширенное описание:Выгрузка данных 
Test ID:test_excel_export_user_friendly 
Test Description:Экспорт в Excel 
Test Criteria:Excel файлы создаются корректно 
Module Path:cli_v4.py 
Function Name:export 
Function Description:Экспортирует данные в различные форматы 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.10.6 
Requirement Description:Расчет статистики 
Расширенное описание:Аналитические запросы 
Test ID:test_database_statistics_calculation 
Test Description:Статистика использования 
Test Criteria:Метрики БД рассчитываются корректно 
Module Path:core/database_v3.py 
Function Name:get_statistics 
Function Description:Возвращает детальную статистику использования 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.10.7 
Requirement Description:Удаление 
Расширенное описание:Операции удаления данных 
Test ID:test_database_cleanup_old_data 
Test Description:Очистка данных 
Test Criteria:Старые данные удаляются безопасно 
Module Path:core/database_v3.py 
Function Name:cleanup_old_records 
Function Description:Удаляет устаревшие записи 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.11
Requirement Description:Поиск вакансий
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.11.1 
Requirement Description:Формирование запроса в API 
Расширенное описание:В цикле по фильтрам преобразование json строки фильтра в url API с поисковыми параметрами. Расчет количества символов в url. Regexp проверка корректности url по правилам API в https\://api.hh.ru/openapi/redoc#tag/Poisk-vakansij/operation/get-vacancies .
Test ID:test_search_finds_new_vacancies 
Test Description:Нет ошибок/исключений в коде при формировании url для test фильтра. 
Test Criteria:Нет ошибок
Module Path:plugins/fetcher_v4.py 
Function Name:build_search_request 
Function Description:Формирует запрос к HH API из параметров фильтра 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:
=== ROW ===
Requirement ID:2.11.2 
Requirement Description:Расчет количества страниц и вакансий 
Расширенное описание:Отправка запросов в API и получение количества страниц всех запросов, расчёт кол-ва id по всем запросам для рачёта % выполнения поиска по всем фильтрам и ожидаемого времени окончания. При превышении кол-ва id по любому запросу более 2000 (параметр - макс.глубина ответа hh), то для данных фильтров в ячейках Статус выводить текст красным шрифтом и записывать в json фильтра в поле status сообщение "Дата-время\: Х ids > limit 2000" и потом сохранять в filters.json. Если превышения не было, то записывать в json в поле status сообщение "Дата-время\: Х ids" и потом сохранять в filters.json.
Test ID:test_search_pagination_calculation 
Test Description:Расчет страниц и id по test фильтру.
Test Criteria:Кол-во страниц и id >0
Module Path:plugins/fetcher_v4.py 
Function Name:calculate_pagination 
Function Description:Определяет количество страниц для обработки 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Requirements_Test_Catalog.md] 
=== ROW ===
Requirement ID:2.11.3 
Requirement Description:Сбор ID вакансий 
Расширенное описание:Извлечение идентификаторов id вакансий из страниц во временную таблицу t исключая дублирование одинаковых id.
Test ID:test_search_finds_new_vacancies 
Test Description:Проверка наличия id в t на test фильтре.
Test Criteria:Кол-во id >0
Module Path:plugins/fetcher_v4.py 
Function Name:extract_vacancy_ids 
Function Description:Извлекает ID вакансий из ответа API 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:
=== ROW ===
Requirement ID:2.11.4 
Requirement Description:Сохранение ID для загрузки вакансий 
Расширенное описание:Формирование очереди загрузки\: проверка наличия в очереди активных/не начатых задач на скачивание версий вакансий по таблице t, добавление в очередь задач скачивание уникальных Id вакансий ( c id фильтра по которому загрузка).
Test ID:
Test Description:Проверка наличия задач в очереди на test фильтре (с микрозадержкой).
Test Criteria:Кол-во задач для фильтра test >0
Module Path:core/database_v3.py 
Function Name:save_vacancy_queue 
Function Description:Сохраняет очередь ID для загрузки 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Requirements_Test_Catalog.md] 
=== ROW ===
Requirement ID:2.12
Requirement Description:Загрузка вакансий
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.12.1 
Requirement Description:Запрос и загрузка вакансий по ID 
Расширенное описание:Загрузка полных данных вакансий (версий) во временную таблицу tt с помощью таскеров по задачам в очереди задач. Преобразование html версий описаний вакансий в txt.
Test ID:test_load_chunk 
Test Description:Проверка размера описания и отсутствия html тегов в первой скаченной test вакансии.
Test Criteria:Полные данные вакансий загружаются 
Module Path:plugins/fetcher_v4.py 
Function Name:fetch_vacancy_details 
Function Description:Загружает полную информацию о вакансии по ID 
Будущие требования:
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Test_Catalog.md] 
=== ROW ===
Requirement ID:2.12.2 
Requirement Description:Проверка уникальности по ID и по набору ключей 
Расширенное описание:Вычисление хэш по набору полей для всех вакансий в tt, поиск в БД скаченых вакансий одним запросом (так должно быть быстрее) пересечения хэша с tt, удаление из tt дублей.
Test ID:test_vacancy_deduplication 
Test Description:Нет пока идей как тестировать
Test Criteria:
Module Path:core/database_v3.py 
Function Name:check_duplicate 
Function Description:Проверяет уникальность по ID и content_hash 
Будущие требования:Несколько хэшей разного уровня, склейка вакансий.
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.12.3 
Requirement Description:Быстрый расчет дополнительных полей 
Расширенное описание:Выяснить какое поле рассчитывается на основании других полей. Вроде как удаленность работы.
Test ID:test_full_vacancy_loading 
Test Description:Проверка непустого значения поля
Test Criteria:Дополнительные поля рассчитываются 
Module Path:plugins/fetcher_v4.py 
Function Name:enrich_vacancy_data 
Function Description:Добавляет вычисляемые поля к данным вакансии 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:
=== ROW ===
Requirement ID:2.12.4 
Requirement Description:Сохранение версий и новых вакансий 
Расширенное описание:Перенос из tt в БД. Проверка, если есть id, то добавляем новую версию, иначе - версию 1.
Test ID:test_vacancy_deduplication 
Test Description:Подсчет Собрано уникальных id по фильтру test - (минус) Удалено дублей в tt = (равно) Количество новых записей версий вакансий в БД (1 или более версий)
Test Criteria:Должно сходиться. Id не теряются.
Module Path:core/database_v3.py 
Function Name:save_with_versioning 
Function Description:Сохраняет данные с автоматическим версионированием 
Будущие требования:Перенос справочников из вакансий в таблицы с версионностью.
Приоритет:1 
Дата:21.09.2025 
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.12.5 
Requirement Description:Удаление скачанных ID из очереди 
Расширенное описание:После загрузки в tt вакансий, удалить задачи из очереди.
Test ID:
Test Description:Проверка остатка задач в очереди после окончания фильтра test
Test Criteria:Остаток должен быть 0
Module Path:core/database_v3.py 
Function Name:remove_from_queue 
Function Description:Удаляет обработанные ID из очереди загрузки 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Req.md] 
=== ROW ===
Requirement ID:2.13
Requirement Description:LLM классификация вакансий
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.13.1 
Requirement Description:Запрос LLM и сохранение ответов 
Расширенное описание:LLM обработка новых вакансий 
Test ID:test_vacancy_analysis_request 
Test Description:Пока в разработка
Test Criteria:Возвращается структурированный ответ; без ошибок 
Module Path:core/host3_client.py 
Function Name:classify_vacancy 
Function Description:Возвращает классификацию/резюме (mock) 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Host_Stubs_Implementation_Report_archived.md] 
=== ROW ===
Requirement ID:2.13.2 
Requirement Description:Процесс последовательных запросов к LLM для набора полей 
Расширенное описание:Батчевая LLM обработка 
Test ID:
Test Description:
Test Criteria:Последовательность\: классификация → сжатие → проверка 
Module Path:core/db_log_handler.py, web/server.py, tests/consolidated_tests.py 
Function Name:
Function Description:Оркестрация LLM batch-задачи (шаги/очередь) 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.13.3 
Requirement Description:Проверка успешности процесса 
Расширенное описание:Валидация LLM результатов 
Test ID:
Test Description:
Test Criteria:Обязательные поля присутствуют; статус ok 
Module Path:core/db_log_handler.py, web/server.py, tests/consolidated_tests.py 
Function Name:
Function Description:Проверяет статус шага и валидность результата перед сохранением 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Functional_Tests_Specification.md] 
=== ROW ===
Requirement ID:2.13.4 
Requirement Description:Сохранение полей классификации и сжатия 
Расширенное описание:Сохранение LLM анализа 
Test ID:
Test Description:
Test Criteria:Поля classification/summary сохранены в БД 
Module Path:core/database_v3.py 
Function Name:save_vacancy 
Function Description:Сохраняет обновленные поля вакансии 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Database_Schema_v4.md] 
=== ROW ===
Requirement ID:2.13.5 
Requirement Description:Удаление идентичных версий вакансий в БД 
Расширенное описание:Дедупликация после LLM 
Test ID:test_vacancy_deduplication 
Test Description:Проверка дубликатов 
Test Criteria:Идентичные версии не создаются 
Module Path:core/database_v3.py 
Function Name:save_with_versioning 
Function Description:Не создает новую версию при одинаковом content_hash 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Requirements_Coverage_Report.md] 
=== ROW ===
Requirement ID:2.14
Requirement Description:Сбор открытой аналитики по работодателям
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.14.1 
Requirement Description:Запрос информации по работодателю с HH 
Расширенное описание:Загрузка полей работодателя через HH API 
Test ID:
Test Description:
Test Criteria:id, name, site_url, description получены 
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[HH_API_Dictionaries_Reference.md] [Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.14.2 
Requirement Description:Пропуск дублей и сохранение новых версий 
Расширенное описание:Дедупликация и версионирование работодателей 
Test ID:
Test Description:
Test Criteria:Идентичные версии не создаются; новая при изменениях 
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Architecture_v4_Host1.md] 
=== ROW ===
Requirement ID:2.15
Requirement Description:Сводка интересных вакансий
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.15.1 
Requirement Description:Отбор по критериям (ручной процесс в БД) 
Расширенное описание:SQL-отбор по статусам/меткам в БД 
Test ID:
Test Description:
Test Criteria:Набор соответствует фильтрам; результат сохранен 
Module Path:core/database_v3.py 
Function Name:
Function Description:Выборка по критериям для аналитики/экспорта 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.15.2 
Requirement Description:Запрос LLM на обзор отобранных вакансий и сжатую аналитику 
Расширенное описание:LLM-обзор отобранных вакансий 
Test ID:
Test Description:
Test Criteria:Краткая аналитика по каждому ID 
Module Path:core/host3_client.py 
Function Name:classify_vacancy 
Function Description:Возвращает summary по вакансиям (mock) 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Host_Stubs_Implementation_Report_archived.md] 
=== ROW ===
Requirement ID:2.15.3 
Requirement Description:Сохранение сводки (CSV, UTF-8) 
Расширенное описание:Экспорт аналитической сводки 
Test ID:
Test Description:
Test Criteria:CSV UTF-8 с ;, корректные даты/числа 
Module Path:cli_v4.py 
Function Name:export 
Function Description:Экспортирует отобранные данные в CSV/Excel 
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[V4_RUNBOOK.md] 
=== ROW ===
Requirement ID:2.15.4 
Requirement Description:Отправка сжатой аналитики в Telegram с вложением сводки 
Расширенное описание:Доставка аналитики пользователю 
Test ID:test_telegram_daily_summary 
Test Description:Проверка доставки 
Test Criteria:Сообщение и файл доставлены в чат 
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3 
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.16
Requirement Description:Отклик на интересные вакансии
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.16.1 
Requirement Description:Отбор по критериям (пользователь проставляет статус вручную в БД) 
Расширенное описание:Селекция для отклика 
Test ID:
Test Description:
Test Criteria:Метки/статусы установлены для набора откликов 
Module Path:core/database_v3.py 
Function Name:
Function Description:Обновляет статусы/флаги кандидата 
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.16.2 
Requirement Description:Запросы LLM на адаптацию сопроводительного письма под вакансии 
Расширенное описание:Генерация персональных писем 
Test ID:
Test Description:
Test Criteria:Текст письма сформирован по профилю 
Module Path:core/host3_client.py 
Function Name:generate_cover_letter 
Function Description:Генерирует письмо по вакансии (mock) 
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Architecture_v4_Host1.md] [Host_Stubs_Implementation_Report_archived.md] 
=== ROW ===
Requirement ID:2.16.3 
Requirement Description:Сохранение писем (редактирование вручную в БД) 
Расширенное описание:Хранение и редактирование писем 
Test ID:
Test Description:
Test Criteria:Письма сохранены и доступны для правки 
Module Path:core/database_v3.py 
Function Name:
Function Description:Сохраняет текст письма в связанной записи 
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Database_Schema_v4.md] 
=== ROW ===
Requirement ID:2.16.4 
Requirement Description:Отправка откликов в API HH 
Расширенное описание:Автоматическая подача откликов 
Test ID:
Test Description:
Test Criteria:POST в HH API с вложением письма; статус 200 
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Requirements_Refinement_Analysis.md] 
=== ROW ===
Requirement ID:2.16.5 
Requirement Description:Запрос LLM на подготовку сводки по откликам [Приоритет 3] 
Расширенное описание:LLM анализ поданных откликов 
Test ID:
Test Description:
Test Criteria:Краткая summary по откликам сформирована 
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Host_Stubs_Implementation_Report_archived.md] 
=== ROW ===
Requirement ID:2.16.6 
Requirement Description:Отправка сводки по откликам в Telegram с вложением расширенной сводки со сжатыми вакансиями и письмами [Приоритет 3] 
Расширенное описание:Отчет о поданных откликах 
Test ID:test_telegram_daily_summary 
Test Description:Проверка доставки 
Test Criteria:Сообщение и файл доставлены в чат 
Module Path:
Function Name:
Function Description:
Будущие требования:Да 
Приоритет:3
Дата:
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.17
Requirement Description:Прочее
Расширенное описание:
Test ID:
Test Description:
Test Criteria:
Module Path:
Function Name:
Function Description:
Будущие требования:
Приоритет:
Дата:
Техническая информация:
=== ROW ===
Requirement ID:2.17.1 
Requirement Description:Авария API HH.ru 
Расширенное описание:Восстановление после 5xx/timeout с экспоненциальной задержкой 
Test ID:test_hh_api_outage_recovery 
Test Description:Восстановление после недоступности API 
Test Criteria:Повторы с backoff; успешный запрос после паузы 
Module Path:plugins/fetcher_v4.py 
Function Name:ExponentialBackoff 
Function Description:Обрабатывает повторы 1s→4s→16s→64s и ошибки 5xx/429 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Detailed_Development_Plan_v4.md] 
=== ROW ===
Requirement ID:2.17.2 
Requirement Description:Переполнение диска 
Расширенное описание:Обнаружение low-space и безопасная деградация 
Test ID:test_disk_full_recovery 
Test Description:Восстановление после переполнения диска 
Test Criteria:Алерт при >90% заполнения; остановка тяжелых задач 
Module Path:core/scheduler_daemon.py 
Function Name:_execute_system_health 
Function Description:Фиксирует disk_percent и формирует alerts 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[Regular_Procedures_v4.md] 
=== ROW ===
Requirement ID:2.17.3 
Requirement Description:Потеря соединения с БД 
Расширенное описание:Повторное подключение и обработка ошибок 
Test ID:test_database_connection_recovery 
Test Description:Восстановление после обрыва БД 
Test Criteria:Успешные повторные операции после ошибки соединения 
Module Path:core/database_v3.py 
Function Name:get_connection 
Function Description:Реинициализация соединения через _connect() 
Будущие требования:
Приоритет:2 
Дата:21.09.2025 
Техническая информация:[System_Revision_Report_archived.md] 
