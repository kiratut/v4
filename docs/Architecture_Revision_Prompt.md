# ПРОМПТ ДЛЯ ПОЛНОГО ПЕРЕСМОТРА АРХИТЕКТУРЫ HH v4

## КОНТЕКСТ И ЦЕЛЬ

Необходимо выполнить **масштабную архитектурную ревизию** проекта HH Tool v4 на основе новых функциональных требований в файле `req_21042309.md`. 

**Важно!** Приоритет = 3 не готов и не берем в работу на данном этапе.

## ОСНОВНЫЕ ЗАДАЧИ

### 1. АНАЛИЗ И ПЛАНИРОВАНИЕ
- Проанализировать все требования из `req_21042309.md` с приоритетами 1-2
- Провести ревизию файлов проекта v4, архитектуры, составить наиболее полное описание текущей, целевой архитектуры и необходимых апдейтов
- Определить устаревшие компоненты для архивации

### 2. ПЕРЕКОМПОНОВКА ФУНКЦИОНАЛА
- Пересмотреть размещение функций по модулям согласно новым требованиям
- Создать недостающие модули для приоритетов 1-2
- Обеспечить единую точку входа через `cli_v4.py`
- написать корректные названия модулей, функций и описание действий функций в полях Module Path, Function Name, Function Description в файле req_21042309.md (с сохранением структуры и форматирования файла).
- убедитья что все настройки и параметры собраны в config_v4.json
- убедиться что поле "type" (тестовый или продуктивный) в filters.json задействовано в коде, поддержано в БД, в конфигурации и в веб-панели и в документах

### 3. КОНСОЛИДАЦИЯ ТЕСТИРОВАНИЯ
- Проанализировать задействованные тесты в текущем коде и требуемые тесты по моему описанию полей Test Description, Test Criteria в файле req_21042309.md
- Обеспечить **единый вывод результатов** всех тестов
- Обновить информацию в колонке Test ID.
- запустить тесты, отработать по ошибкам тестов и функционала, добиться 100% выполнения.

### 6. ПРОЕКТИРОВАНИЕ ВЕБ-ПАНЕЛИ
- Спроектировать веб-панель в соответствии с конфигом config\dashboard_layout.json и мокапом docs\web_panel_mockup.html
- реализовать сборку панели по конфигу
- переделать конфиг с демо на реальные данные, реальные имена переменных, параметров, методов, функций, свойств объектов, ссылки
- текущий назвать config\dashboard_layout_demo.json

## ТЕХНИЧЕСКИЕ ТРЕБОВАНИЯ (далее не строго, т.к. это предлагается моделью)

### Структура архитектуры
```
v4/
├── core/                    # Ядро системы
│   ├── scheduler_daemon.py  # Демон планировщика + самодиагностика
│   ├── database_v3.py       # БД с health check + статистика
│   ├── task_dispatcher.py   # Диспетчер + мониторинг задач
│   ├── auth.py              # Авторизация HH + ротация профилей
│   ├── system_monitor.py    # NEW: Системный мониторинг (2.1.*)
│   ├── config_manager.py    # NEW: Менеджер конфигурации (2.6.*)
│   └── notification.py      # NEW: Telegram уведомления (2.6.2)
├── plugins/
│   ├── fetcher_v4.py        # Загрузчик + обработка ошибок API
│   └── base.py              # Базовые классы
├── tests/
│   ├── consolidated_tests.py # NEW: Основные тесты приоритет 1-2
│   └── diagnostic_tests.py   # NEW: Самодиагностика и мониторинг
├── web/
│   ├── monitoring_dashboard.py # Обновленная панель
│   ├── static/
│   │   ├── dashboard.js     # NEW: Блочная структура
│   │   └── style.css        # NEW: Responsive design
│   └── templates/
│       └── dashboard.html   # NEW: Модульный дизайн
├── config/
│   ├── config_v4.json       # Расширенная конфигурация
│   ├── auth_roles.json      # Профили авторизации
│   └── filters.json         # Фильтры поиска
└── cli_v4.py                # Единая точка входа - все команды
```
Настроить venv если не настроена.

### Система тестирования
- **Приоритет 1 тесты**: критические, должны проходить 100%
- **Приоритет 2 тесты**: важные, могут иметь известные ограничения
- **Единый JSON отчет** с детализацией по каждому тесту
- **CLI команды**: `python cli_v4.py test consolidated --priority 1,2`
- **Диагностика**: `python cli_v4.py test diagnostic --output report.json`

### Требования к коду
- **Обратная совместимость**: все существующие команды должны работать
- **Модульность**: четкое разделение ответственности
- **Документирование**: каждая функция с docstring
- **Логирование**: централизованное в `logs/app.log`
- **Конфигурируемость**: все параметры в config файлах
- **Тестируемость**: каждый модуль покрыт тестами

## ОЖИДАЕМЫЕ РЕЗУЛЬТАТЫ

### Документация
1. **Основной план ревизии** - детальный план с этапами
2. **Справочник параметров** - полная документация всех настроек 2.6
3. **Дизайн веб-панели** - HTML/CSS макет с описанием блоков
4. **Итоговый отчет** - сводка выполненных работ и достижений

### Функционал
1. **Новые модули** - system_monitor, config_manager, notification
2. **Консолидированные тесты** - единая система с JSON отчетами
3. **Обновленный CLI** - новые команды тестирования
4. **Расширенная конфигурация** - все параметры задокументированы

### Качество
- **97%+ покрытие** требований приоритетов 1-2
- **Единый стиль кода** во всех модулях
- **Полная документация** всех компонентов
- **Автоматические тесты** для каждого требования

## КРИТЕРИИ УСПЕХА

### Количественные
- ✅ 100% покрытие требований приоритета 1
- ✅ 95%+ покрытие требований приоритета 2
- ✅ Все консолидированные тесты выполняются за <10 секунд
- ✅ 100+ параметров конфигурации задокументировано

### Качественные
- ✅ Система готова к продакшену
- ✅ Код соответствует принципам SOLID
- ✅ Документация полная и актуальная
- ✅ Обратная совместимость сохранена

## ДОПОЛНИТЕЛЬНЫЕ ИНСТРУКЦИИ

- **Использовать русский язык** для всех комментариев и документации
- **Следовать стандартам PEP8** для Python кода
- **Создавать подробные commit сообщения** на русском
- **Тестировать каждый компонент** перед интеграцией
- **Документировать все изменения** в соответствующих файлах

---

## ЗАПРОС НА ПРОВЕРКУ РАБОТЫ

**Уважаемый коллега!**

После выполнения данной архитектурной ревизии, пожалуйста, **внимательно проверьте результаты моей работы**:

### Что нужно проверить:

1. **Соответствие требованиям**
   - Все ли требования приоритетов 1-2 из `req_21042309.md` учтены
   - Корректность реализации каждого пункта
   - Полнота покрытия функционала

2. **Качество кода**
   - Соблюдение принципов архитектуры
   - Читаемость и документированность
   - Отсутствие дублирования
   - Соответствие стандартам Python

3. **Функциональность**
   ```bash
   # Запустите эти команды для проверки:
   python test_architectural_revision.py
   python cli_v4.py test consolidated --priority 1,2
   python cli_v4.py test diagnostic --output diagnostic_report.json
   ```

4. **Документация**
   - Полнота описания в файлах `/docs/`
   - Корректность параметров в разделе 2.6
   - Актуальность README и инструкций

5. **Интеграция**
   - Работоспособность всех существующих команд
   - Корректность новых CLI команд
   - Совместимость с текущей инфраструктурой

### Обратная связь приветствуется по:
- Упущенным требованиям или функциям
- Проблемам в архитектуре или коде
- Предложениям по улучшению
- Найденным багам или несоответствиям

**Спасибо за вашу тщательную проверку!** Ваш фидбек поможет сделать систему еще лучше и надежнее.

---

*Промпт создан: 23.09.2025 18:24*  
*Версия: v1.0*  
*Автор: AI Assistant*
